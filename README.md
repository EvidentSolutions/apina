# Apina

Apina creates client-side TypeScript from server-side APIs. Apina reads Spring Web MVC's
`@RestController` annotated classes and their related Jackson classes and creates related
data type and endpoint interfaces. It also creates implementation for the interfaces using
AngularJS' `$http` service.

## Using the Gradle-plugin

Include something like the following in your web application project:

```groovy
plugins {
    id "fi.evident.apina" version "0.2.2"
}

apina {
    // set the name of the created TypeScript file
    target = new File(project(":frontend").projectDir, 'app/apina-api.ts')
}

// tell the frontend to run apina in setup
// (the 'setup' task will probably be different for you)
tasks.findByPath(":frontend:setup").dependsOn apina
```

## Using generated code

When you import the generated code, it will automatically add an AngularJS module
named `apina.api`. You need to add that as a dependency:

```typescript
import 'apina-api';

var myApp = angular.module('myapp', ['apina.api']);
```

The code generated by Apina exports two important modules: `Types` and `Endpoints`.
`Types` contains definitions for all Jackson data types and `Endpoints` contains 
various endpoints grouped into endpoint groups. Each endpoint group corresponds to
single Spring controller and each endpoint to a single request handler method.

There's an interface named `Endpoints.IEndpointGroups` which contains references to
all endpoint groups and an instance of this interface is registered to AngularJS as
`endpointGroups`. If you include the Angular module `apina.endpoints`, each
endpoint will be registered directly with key `Endpoints.MyEndpoint.KEY`.

### Example

If you have a Spring controller named `DocumentsController` with a method
`Document findDocument(int id)`, you can say the following:

```typescript
import { Types, Endpoints } from 'apina-api';

class MyController {
    document: Types.Document
    
    static $inject = [Endpoints.Documents.KEY];
    
    constructor(documents: Endpoints.Documents) {
        documents.findDocument(42).then(doc => this.document = doc);
    }
}

angular.controller('MyController', MyController);
```

## Modules

  - `apina-core` main apina code
  - `apina-cli` command line interface for running conversion
  - `apina-gradle` plugin for Gradle
